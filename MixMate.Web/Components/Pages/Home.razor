@page "/"
@using MixMate.Core.Entities
@rendermode InteractiveServer

<MudPopoverProvider /> @* For whatever reason this wasn't being picked up properly in MainLayout.razor so its here instead *@

<PageTitle>Mix Mate</PageTitle>

<h1>Mix Mate</h1>

@if (Errors.Count > 0)
{
    <h2>Error</h2>
    <ul class="=text-danger">
        @foreach (var error in Errors)
        {
            <li>@error</li>
        }
    </ul>
}

<InputFile class="form-control p-1 m-1" OnChange="@LoadFiles" multiple accept=".txt" />
    
<MudCard Class="p-1 m-1">
    <MudCardContent>
        <MudGrid Justify="Justify.SpaceBetween">
            @if (MainSong == null)
            {
                <MudItem>
                    <MudText>
                        Select a song from below to start mixing!
                    </MudText>
                </MudItem>
            }
            else
            {
                <MudItem>
                    <MudText>
                        Main Song: @MainSong?.Title - @MainSong?.Artist
                    </MudText>
                </MudItem>
            }
            <MudItem >
                <MudSelect T="string" Placeholder="Mixing techniques">
                    <MudSelectItem T="string">Smooth</MudSelectItem>
                    <MudSelectItem T="string">Energy boost</MudSelectItem>
                </MudSelect>
            </MudItem>
        </MudGrid>
    </MudCardContent>
</MudCard>

<MudDataGrid class="p-1 m-1" Items="_songs" T="Song" RowClick="@SetMainSong" Hover="true" RowStyleFunc="@RowStyleFunc">
    <Columns>
        <PropertyColumn Property="song => song.Title"/>
        <PropertyColumn Property="song => song.Artist" />
        <PropertyColumn Property="song => song.Album" />
        <PropertyColumn Property="song => song.Genre" />
        <PropertyColumn Property="song => song.Bpm" />
        <PropertyColumn Property="song => song.Duration" />
        <PropertyColumn Property="song => song.Key.GetFullKeyForDisplay()" />
    </Columns>
</MudDataGrid>
