@page "/"
@using MixMate.Core.Entities
@rendermode InteractiveServer

<MudPopoverProvider /> @* For whatever reason this wasn't being picked up properly in MainLayout.razor so its here instead *@

<PageTitle>Mix Mate</PageTitle>

<h1>Mix Mate</h1>

@if (_errors.Count > 0)
{
    <h2>Error</h2>
    <ul class="=text-danger">
        @foreach (var error in _errors)
        {
            <li>@error</li>
        }
    </ul>
}

<InputFile class="form-control p-1 m-1" OnChange="@LoadFiles" multiple accept=".txt" />
    
<MudCard Class="p-1 m-1">
    <MudCardContent>
        <MudGrid Justify="Justify.SpaceBetween">
            <MudItem>
                <MudText>
                    @MainSongCardText
                </MudText>
            </MudItem>
            <MudItem >
                <MudSelect @bind-Value="_selectedMixingTechnique" Placeholder="Mixing techniques">
                    @foreach (string technique in _availableMixingTechniqueNames)
                    {
                        <MudSelectItem Value="@technique">@technique</MudSelectItem>
                    }
                </MudSelect>
            </MudItem>
        </MudGrid>
    </MudCardContent>
</MudCard>

<MudDataGrid class="p-1 m-1" Items="_songs" T="Song" RowClick="@SetMainSong" Hover="true" RowStyleFunc="@RowStyleFunc">
    <Columns>
        <PropertyColumn Property="song => song.Title"/>
        <PropertyColumn Property="song => song.Artist" />
        <PropertyColumn Property="song => song.Album" />
        <PropertyColumn Property="song => song.Genre" />
        <PropertyColumn Property="song => song.Bpm" />
        <PropertyColumn Property="song => song.Duration" />
        <PropertyColumn Property="song => song.Key.GetFullKeyForDisplay()" />
    </Columns>
</MudDataGrid>
